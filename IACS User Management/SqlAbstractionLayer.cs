using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;
using System.Data.SqlClient;

namespace IACS_User_Management
{
    class SqlAbstractionLayer
    {
        private String dbUserName;
        private String dbPassword;
        private String serverName;
        private String dbName;
        private String mapImage = "0xFFD8FFE000104A4649460001010100C800C80000FFDB0043000201010201010202020202020202030503030303030604040305070607070706070708090B0908080A0807070A0D0A0A0B0C0C0C0C07090E0F0D0C0E0B0C0C0CFFDB004301020202030303060303060C0807080C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0CFFC000110807FD07EA03012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00FDFCA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF917F635FD96BE1BF8B3E1CC5E32D5FE1FF0083F54F173F8AFC4176FACDE6970CF7EF3C7AEDF2C7219994B96511A05249DA1140E1457D755E57FB3D7C31B9F835F0D23F0FDE5D4179711EA9AAEA0658959576DE6A575788B83CE5567D87FDA8DB1C628035BE277C28F0C7C68D01749F17786F45F1569714EB711DA6AD691DD402519C3EC7046E196C3633CD704DFF0004FEF8127A7C1BF865B7A0FF008A6ED3A7FDF15EBF4500645B781744B2F03AF8620D1F4E87C36B69F60FECB8ADD16D16DB6EDF24478DBE5ED246CC11CD79B0FF00827FFC0BD8BFF166BE18AFB0F0DDAE07D3E4F4C715EC14500733F0BFE0F784FE0868B3E9DE0CF0BE83E15B1B89BED12DB691631D9C53484052ECA8002DB401BBAF15C9F893F625F837E33F105F6ADAC7C29F87BA9EA9A8CCD71757977A0DB4D3DD48DCB3BB3212CC4FF175AF52A280382F865FB2DFC33F82FE207D5BC23F0FFC1BE17D52585ADDEF34AD220B49DA2382537A283B490323A1C53FE27FECD1F0EFE37EB96FA978D3C03E11F156A16F0FD9E2B9D5B4B86F25863CEE08AD22921771276F4E6BBAA2803CA744FD86BE0BF86759B5D4B4EF84BF0E6C750B0956E2DAE20F0FDB47241229CABAB04CAB0201047422BB4F89DF0A7C31F1A3405D27C5DE1BD17C55A5C53ADC4769AB5A47770094670FB1C11B865B0C0679AE8A8A00F206FF00827F7C09EDF06FE196DE833E1BB4FF00E375E916BE05D12C7C0EBE188347D3A1F0DADA1B0FECB8ADD16D16DB6EDF24478DBE5952414C11CD6BD1401E3E3FE09FDF02F62FFC59AF862BEA0786ED703E9F27A638AEEBE177C1DF097C0FD167D3BC19E17D07C2B637137DA25B6D26C63B38A69080A5D950005B6803775E2BA6A2803CB7C49FB12FC1BF19F882FB56D63E14FC3ED5354D4666B8BABCBBD06DA69EEA46E59E466425989FE23CD6A7C32FD96FE19FC17F10BEADE11F87FE0DF0BEA9242D6EF79A569105A5C344D82537A283B490323A1C577D450070BF13FF00668F877F1BF5BB7D4BC69E02F08F8AB50B687ECF15CEADA5C3792431E77044691490BB893B7A73587A27EC33F05FC33ACDAEA5A7FC25F87363A8584AB716D710F87ADA3920914E55D5826558100823A115EAD450073BF13BE14F867E34680BA4F8BBC39A2F8AB4B8A75B88ED356B48EEE0128CE1F638C6E196C3000F35C137FC13FBE04F6F837F0CB6F419F0DDA7FF001BAF5FA280322D7C0BA258781D7C316FA3E9D0F86D6D0D87F65C5022DA2DB6DDBE488F1B76152414C11CD79B0FF827F7C0BD8BFF00166BE18AF1C81E1BB5C0FA7C9E98E2BD828A00E67E177C1DF097C0FD167D3BC19E17D07C2B637337DA25B6D22C63B38A69080A5D950005B680377518AE4FC49FB12FC1CF19F882FB56D63E14FC3ED5354D4666B8BABCBBD06DA6B8BA91B9679199096627F8BAD7A951401C0FC32FD96BE19FC17F10B6ADE11F87FE0DF0BEA9242D6EF79A569105A5C189B04A6F45076920647438A93E27FECD1F0EFE37EB76FA978D3C05E11F156A16D0FD9E2B9D5B4B86F24863CEE088D22921771276F4E6BBAA2803CA744FD867E0BF86B59B5D474FF84BF0E6CB50B0996E2DAE21F0F5B47241229CABAB04CAB0201047422BB4F89DF0A7C33F1A3405D27C5DE1CD1BC55A5C73ADC4769AB5A4777009467126C718DC32D86001E6BA2A2803C81BFE09FDF027B7C1BF865B7A0CF86ED3FF008DD7A45A781344B0F032F862DF47D3A1F0DADA1B01A5C5022DA2DB6DDBE488F1B76152414C11CD6BD1401E3E3FE09FDF02B62FFC59AF862BEC3C376B81F4F93D31C5775F0BBE0EF84BE07E8B71A7F833C2FA0F856C6E66FB44B6DA458C76714D21014BB2A000B6D006EEA315D351401E5BE24FD897E0E78D3C417DAB6B1F0A7E1F6A9AA6A3335C5D5E5DE836D34F752372CF233212CC4FF11E6B53E197ECB5F0CFE0BF885B56F08FC3FF0006F85F549216B77BCD2B4882D2E0C4D82537A283B490323A1C577D450070BF13FF00669F877F1C35BB7D4BC69E03F08F8AB50B687ECF15CEADA5C3792431E776C4691490BB893B7A73587A2FEC33F05FC35ACDAEA5A7FC25F87365A8584CB716D710F87ADA3920914EE575609956040208E8457AB51401CEFC4EF855E19F8CFA02E93E2EF0E68DE2AD2A3996E23B4D5AD23BB804AB9C3EC718DC32D86C03CD704DFF0004FEF8127A7C1BF865B7A0CF86ED3A7FDFBAF5FA280322D3C0BA269FE064F0C5BE8FA743E1B5B43A78D2E28112D12DB6EDF24478DBE5952414C11CD79B0FF827FF00C0BD8BFF00166FE18AFA81E1BB5C0FFC73D31C57B051401CCFC2EF83BE12F81FA2DC69FE0CF0BE83E15B1B99BED135B691631D9C53484052ECA8002DB401BBA8C5729E24FD89BE0E78D3C417DAB6B1F0A7E1FEA9AAEA5335C5D5E5DE836D35C5D48DCB3BB3212CC4FF00175AF51A280381F865FB2D7C33F82FE216D5BC23F0FF00C1BE17D52485ADDEF34AD220B4B83136094DE8A0ED240C8E87152FC4FF00D9A7E1DFC70D6ADF52F1A780BC23E2BD42D61FB3C573AB6970DE490C79DDB11A45242EE24EDE9CD7734500794E8BFB0C7C16F0DEB16BA8E9FF00097E1CD9DFD8CCB716D710F87ADA3920914EE575609956040208E845751F1CFE16786FE32FC3CD434BF16787F49F1369704525DC76DA9DA25D44B32C6FB5C2B02378DCC0100373C118AEBAA0D4628E6B295665568991C3EEC6D2BB1B20E7D7F0E9D4500721FB0D5CC979FB13FC1E9A691A6965F0468AEEECC599D8D8404924F273EB5EA5591E00D3347D13C09A2D9787A3B18740B3B1860D323B260D6C96AB1AAC2222B9050205DA4718C56BD0014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015E3FFB307C48D53E2D7C275D735A6B66D464D6758B263043E5298ED753BAB58B8C9E7CA8A3073D4AB1E8457B0578AFEC81E15D4BC13F0361D3B57B1B8D3EF975ED7AE0C132E1C4736B37D3C4C7D9E296371ECE0F7A00F4EA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AA3E275DDE19D53FEBCA61F5F90D5EAABAC5A2DFE99716ECDB56E21922623190A51B279FEBC73CD0071FF00B08F1FB0FF00C1AFFB11B44FFD2082BD5AB99F82FF000E2DBE0EFC1EF0A7842CEE2E2F2CFC2BA3DA68D05C4E079B3A5BC290ABBE38DC420271C64D74D400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400579B7C1AF8A76BF1ABC17FF090D9D9DCD84126A17FA7F9333233AB59DE4F68C7E53C0668B78FF6644F4C0F49AF03FD8582B7ECE90B2F3FF1527897A741FF0013FD47FC2803D828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A9F8865783C3FA8491BB46F1DA4ACACBD54843823DC55CAA7AFC0F77A1DEC31E37CF6F2C4A49C004A3633C1FCFA0A00C0FD8EBC4FA878D7F646F857AD6AD793EA1AAEAFE10D26F6F6EA76DD25CCF25942F248C7BB333124FA9AF47AE17F65EF87FA87C26FD99FE1DF85756FB3FF006AF867C33A6E937BE43EF8BCF82D628A4DADDD7721C1EE2BBAA0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002B87F02EB9A1788B46FB5786EE34EBAD27ED371123D98558BCE49E58EE000001BBCF8E40D8EAEB213C935DC5781FEC2C9B7F6758704EDFF008493C49C7FDC7AFC7FECBDBD7D724807B051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400555D6AE9AC748BCB8550CD6F6F24AA09201210E3A7F31C8AB5547C4D93E1BD49554B3359CC0000924EC6F41FE7DE802BFECE7F11EE3E31FECF9E05F17DDDB416775E2BF0F586B33DBC0498A07B8B68E6645279DA0B9033CE057655E61FB1269B71A37EC61F08ACEF2DEE2D2EED7C15A3433C13C66396175B18432329E55810410790457A7D0014514500145145001451450014D2E07AFE029D5F2FF89FE037837E3B7EDE9E3E7F1A786F48F147FC239E14F0C4BA52EA707DA174D792E75A691A1563B636668612C40F9BCA5CE703001F4F79CBB80CF27A714BBB1EBF9570FF00123E1A681F18BC2771A0F8B347B0F1168B74E924D637D1F9B04AC8DBD4953D70D8383C640E38AF361FF04EEF812A72BF087C02ADD8FF0064C67B83FD05007D00D32A0E4FE94A5B1EBF95715E0EF87BA27C3DF055AF86F42D2ECB47D02CA2682DF4FB48FCAB78918B1601463A976248C124E735E66BFF0004EDF80EBB71F083C03F29047FC4AA3ED401F401902F5FE542B875C8FE55E6BF097E007827E02DA5F5BF82BC2BA1F8561D4D91EED74CB55B7FB4145654DD8EBB433601C81B89C726B9FF001D7EC55F08FE27F8BAFB5EF11FC36F07EB9ADEA4E24BBBEBCB05967B860A141663C9C2A803D0003A5007B56F18EFF950B2AB9E3B75E2BC73E1C7EC79F0AFE0FF008AE0D77C2BF0F7C27E1ED62D6378A1BDB1D3D219E1574D8E1587232BF2E460E09E7935A7F173F66FF00FC7CBAB19BC6FE0FD03C592E9AAE968DA9DA89CDB0720B84CF4DC40CF73B467381401EA3BBEBF95279ABB80CF27A715E056DFF04F6F81B65711CD0FC25F01C5244E24565D2A3C8604107A7AA8EB915E8DF123E1A681F18BC2971A178AF47B0F1168B74E924F637D1F9B04AC8DBD4953C1C37383C640E062803B8DD8F5FCA91A6541C9FD2BE7F1FF0004EEF8120E57E10F8055BD7FB2633DC1FE82BD33C1DF0F744F879E0AB5F0DE83A5D968FA05944D05BE9F691F956F123162C028C752EC4918249CE6803B52D8F5FCA90C817AFF002AF9FD7FE09DBF01D48FF8B41E01F94823FE2551F6AEDBE127C00F04FC04B4BEB7F04F85743F0AC3A9B23DDAE996AB6FF6828ACA9BB1D76866C67206E271C9A00F4A570E323F951BC63BFE55E2BE3AFD8ABE11FC4FF16DF6BDE24F86DE0FD735BD49C49757D7960B2CD70C14282CC79E14003D0002A6F871FB1DFC2BF83FE2B835DF0AFC3DF09F87B58B58DE286F6C74F4867855D3638561C8CAFCB91838279E4D007B22C8AE78EDED4BBBEBF957977C5CFD9BFC03F1F2EAC66F1BF83F40F164BA6ABA5A36A76A2736C1C82E173D3240CF73B46738AE4ADBFE09EDF036CEE23961F84BE0386489C48ACBA54790C0820F4F551D722803DF7CD5DD8CF5F6A5DD8F5FCAB88F891F0D740F8C3E14B8D0BC57A3D8788B45BA7479EC6FA3F3609591B7A92A7AE1B9C1E32070315E6A3FE09DDF0241CAFC21F00AB7AFF64C67B83FD05007D00D32A0E4FE94A5B1EBF95715E0EF87BA27C3CF055AF86F41D2ECB47D02CA2682DF4FB48FCAB78918B1601463A976248C124E735E663FE09DDF01D48FF8B43E01F94E47FC4AA3A00FA01A454EB9FCA955B7AE47F2AF9FFC45E1BF07FEC2FF000E1B54F01F81FC3DA32EB5E25F0F68F776F6108B359C5F6B167A68958A8249892F24755E84823E5DC48F7F823F26255E0E3A903AD003A8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002B82F86DF0DF4FF845E1B1A0E94B70B631DE5E5E8F3A4F318C9757535D4BF310323CD9A4C63A0651D8D77B5E11FB125F5D6A5F00229AEEE2E2F263E22F10A79B34AD23954D6EF9106589242A82A3D1428E8A2803D6E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002ABEA774B656134D26765BC6F31C0C9C2A374E47AF41CF3C558AA3E2738F0C6A9D7FE3CE6E83FD86A00B9F0B7C7FA7FC58F867E1DF15692D70DA5F89B4CB6D5AC8CF1F972982789658F72F3B5B6B8C8EC6B7ABCA7F612FF931FF00837FF623689D3FEBC20AF56A0028A28A0028A28A0028A28A002BCC749F85F7DA17ED2FE36F18493DAC9A7F89B42D174BB7857779D149652EA4F23371B76B7DB620307F85BDABD3ABCB746F89FA96B9FB5078EBC233C567FD93E1AD0744D4ECDD5489DA5BD97534983B671B716510181C6E6A00ED85140E945001451450014514500145145001451450014514500145145001451450014514500145145001451450078FFEDC76735F7C0ED352086499D7C77E0B90845DC5557C57A4B31C7B2824F1D01AF7A81FCC895B39CF7AE27E20FC4BD2BE136856FAB6B334D6F6736A5A7E928F1C4D213717D7B058DBAE14670D3DCC40B7450493C0247696C19605DC36B6391E9F95004945145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015E57FB3D7C31BAF835F0CE3F0FDE5D5BDE5C47AA6ABA819615654DB79A95D5E22E1B9CAACFB0FF00B51B638C57AA578FFECC3F12354F8B5F0A175CD69AD4EA326B3AC5931821F2D4C76BA9DD5AC5C64F3E5451839EA558F422803D128A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A0D4628E6B395665468991C3EFC6D2A51B20E7D7F0E9D454F547C4EBBBC33AA7FD794C3EBF21A00D3F00695A3E85E04D16C7C3F1D8C3A05958C36FA64764C1AD92D523558444464140817691C6315AF5E53FB08F1FB0FF00C1AFFB11B44FFD2082BD5A800A28A2800A28A2800A28A2800AF19F0C786F50B1FDB3FE266AD3D8DD43A5EA1E17F0D5BDADE346443712C33EB4D322B742C8258891DBCC5F5AF66AE16DFE2AE9FAEFC68F11F83E2B7BB8F52F0BE9BA76A9713B2AF932C77AF76B18439CEE5FB0C84F03AAF5C9A00DEA281D28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00F1BFDBB4E3E05E97EBFF09F782703D7FE2ADD1EBDF91F7AE718F6AE3FC6BE15D17C69A34363E20B7B6BAD396FEC6F5639E431A8B9B7BB86E2D5C1047CCB731C0C067920020824575D6641B64DBF771C739A00928A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BC57F640F0AEA5E0AF81B0E9DABD8DC69F7CBAF6BD70609970E239B5ABE9E263ECF14B1B8F55753DEBDAABCDFE0D7C53B5F8D3E0BFF8486CACEE6C6DE4D42FF4FF00267646756B4BC9ED58FCA7A3345BC7FB2E9E98001D651451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400555D62D56FF004CB8B766DAB710C913118C8528D93CFF005E39E6AD553F10CAF0787F50923768DE3B595D58755210E08F71400EF82DF0E2DFE0E7C1DF09F842CEE6E2F2D3C29A3DA68D0DC4E009674B78521577C71B88404E3B9AE9ABCE3F63AF13EA1E36FD91BE166B5AB5E4FA86ABABF84349BDBDBA99B749733CB650BC9231EECCCC493EA6BD1E800A28A2800A28A2800A28A2800AF0CF07303FB787C5A191B97C21E14C8CF4CDC6BD5EE75CAB5C6832FC45D562B47D2DBC471D9DA9D4D63D9F6C5B766985B7998F9F616173B32700F98477A00BD4503A5140051451400514514005145140051451400514514005145140051451400514514005145140051451401E37FB77286F813A5E5770FF0084FBC10718CFFCCDBA3D7BFAB07191C8AF38F8D3F0921F8D9E0CB5D0EE2F25D3E3835DD1B5A13247E665B4ED52D75158C8240FDE35A04CE7E50E4E0E307D12D4E605E7771D477A00928A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BC0FF6170AFF00B3AC2CBCFF00C549E25E9D07FC4FF51FF0AF7CAE1FC0BADE83E20D1BED5E1BB8D36E749FB4DC448F641445E724F2A5C000003779E9206C7F1AC84F24D006E51451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400553D7E07BBD0EF618F1BEE2DE589493800946C6783E9D7A0EF572AAEB574D63A45E5C2A866B7B7925504900908D8E9D3EA39140197FB2EF80350F84FF00B33FC3BF0AEADF671AAF867C31A6E957A207DF109E0B58A2936B775DC8707B8AEEAB8DFD9CFE23DC7C63FD9F3C0BE2FBBB682CEEBC57E1EB0D666B784931C0F716D1CCC8A4F3B41720679C0AECA800A28A2800A28A2800A28A2800AF0BF07C6BFF000DE1F169B68DCDE10F0A027D7FD235FF00F135EE95C4C5F0BEC342F8BDAFF8BE17BBFED2F1369D61A65D2B3EE844564F74F1155C64366F65CF3CED5A00DAA281D28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00F30FDAEFC6DAB7C3EF84BA7EA3A2DF4BA7DF4BE31F0A69CF34614B1B7BAF126996B711FCC08C4904D2A13D40724107047B4C682340ABD07A9CD78FFED4DF0DB56F8B1F0B6C749D1628A6BC87C57E18D59D2491631F67B1D7F4FBEB86CB1C6560B79481D5880064900FAF5B1CC2BC11EC68024A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF03FD85D367ECEB0E09DBFF09278938FFB8F5F8FFD97B7AFA924FBE5703F0D7E1BE9FF0008BC34341D296E16C63BCBCBD1E749E63192EAEA6BA97E6C0C8F3669318E8ACA3B1A00E8A8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A8F89B27C37A92AA9666B3980001249D87D07F9F7ABD55F53BA5B2B09A6933B2DE3798E064E151BA73EFD073CF1401CA7EC47A75C68FF00B187C22B3BCB79ED6EAD7C15A3433413C66396175B18432B29E55810410790457A7D60FC2EF1FE9FF163E19F877C55A4B4EDA5F89B4DB6D56C8CF1F972182789658F72FF000B6D7191D8D6F50014514500145145001451450015E2BE15D6AFAE7F6D9F8A1A7C97D75269F67E15F0C4F6F6AF21686DE4927D6C48E88780CFE545B88EBE5AFA57B55798E93F0BEFB42FDA63C6DE30927B5934FF0013685A2E976F0AEEF3A292CA5D49E42D91B76B7DB620307F85BDA803B21C0A281450014514500145145001451450014514500145145001451450014514500145145001451450014514500713F1FBE2D4DF04FC0967AE416316A125C788B41D13CA92431855D4758B2D39A4DC013945BB6703F88A01919C8F50823F26255EB8EE075AF05FDB8ECE6BEF81DA6A430C933AF8EFC172108325557C57A4B31FC141278E80D7BD40FE644AD9CE7BD003A8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BC23F625BEBAD4FE00C335E5CDC5E4C7C45E214F36699A472A9ADDF22292C4921554A8F450A3A28AF77AF2BFD9E7E18DD7C1BF8671F87EF2EADEF2E23D5755D40CB0AB2A6DBCD4AEAF11406E72AB3ED3FED46D8E31401DC51451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400551F139C786354EBFF001E73741FEC355EA83518A39ACE559955A26470FBB1B4A946C839F5FC3A751401C67EC25FF263FF0006FF00EC46D13A7FD78415EAD591F0FF004AD1F41F0268B63E1F8ACA1D02C6C61B7D323B360D6E96A91AAC2232320A040BB48E318AD7A0028A28A0028A28A0028A28A002BCB747F8A1A96B9FB4FF008E7C233C369FD95E1AD0744D4ECE455226696F65D4D260E738DB8B2880C0FE26AF52AF19F0C787350B1FDB3FE266AB3D8DD43A5EA1E16F0D5BDADDB46443712433EB4D2A2B742C8258891DBCC5F5A00F4A1D28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00C3F883F12B4AF84DA1DBEADACCD35BD9CDA969FA4A3C713484DC5F5EC1636EB85E70D3DCC409E8A09278048ED2D832C0BB86D6C723D3F2AF03FDBB4E3E05E97EBFF09F782703D7FE2ADD1EBDF91F7AE718F6A0075145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400578FFECC3F12754F8B7F0A175CD6BECBFDA326B3AC5937910F96A63B5D4EEAD62E3279F2E28C127A9563D08AF60AF14FD8FF00C2DA9782FE06C3A76AD6371A7DF2EBDAF5C18265DAE239B5ABE9A263ECF14B1B8F55753DE803D3E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A8F89D77786754FFAF2987D7E4357AAAEB16AB7FA65C5BB36D5B8864898F190A51B279F4F7E39E68038FF00D8478FD87FE0D7FD88DA27FE90415EAD5CCFC16F8716FF00073E0EF84FC216773717969E15D1ED34686E27004B3A5BC290ABB01C6E210138EE6BA6A0028A28A0028A28A0028A28A002B85B7F8ABA7EBBF1A3C47E0F8ADEEE3D4BC2FA6E9DAA5CCCCA3C9963BD7BB58C21CE772FD865278EEBD735DD5786783981FDBC3E2C8C8DCBE10F0A6467A66E35EA00F571D28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00C9F1AF85745F1A68F0D8F882DEDAEB4E5BFB1BD58E790C6A2E6DEEE1B8B570411F32DCC703019E4800820915D759906D936FDDC71CE6BC0FF006EE5DDF02B4BC8DC3FE13EF04718CFFCCDBA3D7BFAB07191C8A005A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF37F835F14ED3E34F833FE121B1B3BAB1B79350BED3FC99D90BAB5A5E4F6AE7E53D19A2DE3FD974F4C0F48AF04FD85F6B7ECEB0B2F3FF00152789471D07FC4FF51FF0A00F5FA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AA7E2195E0F0FEA1246ED1BC76B2BAB2F556087047B8AB954F5F824BBD0EF618F1E65C5BCB1292700128D8EC7F3E83BD0060FEC77E27D43C6DFB237C2CD6B56BC9B50D5758F086937B7B7531DD25CCF2D942F248C7BB333127DCD7A3570BFB2EF80350F84FFB33FC3BF0AEAC201AB7867C31A6E957A207F32313C16B14526D6EEBB90E0F715DD50014514500145145001451450015CAB4DA0CBF117558ED1B4C6F11C7676A75258F67DB16DD9A616DE663E7D8585CECCF00F998EF5D55785F83E25FF86F0F8B4DB46E6F08785013EBFE91AFFF0089A00F581D28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00E4BE357C2487E367832D743B8BC974F4B7D7746D6C4C91F9996D3B54B5D456320903F78D681339F94393838C1F45B5398179DDC751DEBC63F6BAF1BEADF0F7E12E9FA8E8B7D269F7D2F8C7C29A73CD1852CD6F75E24D32D6E23F981189209A5427A80E4820E08F698D0468157A0F539A0075145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400570FE05D6741D7F46FB4F86EE34DB8D27ED371123D9051179C93CA97000000DDE7A481B1FC6B213C935DC5781FEC2C9B3F6758704EDFF008493C49C7FDC7AFC7FECBDBD4F724900F60A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AABAD5D358E917970ABB9ADEDE49541240242363A7F31C8AB5547C4D93E1BD49554B3359CC0000924EC3E83FCFBD0057FD9D3E23DC7C63FD9F7C0BE2FBAB686CEEBC57E1EB0D666B784968E07B8B68E66452792AA5C819E702BB2AF2FFD88F4EB8D23F62FF84369776F3DADD5AF82B468668668CC7242EB630865653CAB020820F208AF50A0028A28A0028A28A0028A28A002B898BE17D8685F17F5FF00184325D7F69789B4EB0D32E959F30AC564F74F1155C64366F65CF3CED5AEDABC57C2BADDFDCFEDB1F1434F92FAEA4D3ACFC2BE199EDED5E42D0DBC924FAD891D13A067F2A2DC7BF96BE9401E9C3A5140E05140051451400514514005145140051451400514514005145140051451400514514005145140051451401E73FB537C36D5BE2BFC2CB1D27458A29AF21F15F863567492458C7D9EC75FD3EFAE1B2C719582DE520756200192403EBF6FFEA57823D8D7987C7DF8B537C13F0259EB90D8C7A84971E22D0744F29E431855D4758B2D39A4DC013945BB6703F88A01919C8F50823F26255EB8EE075A00751451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005703F0D3E1BE9FF0008BC35FD83A52DCAD8C779797A3CF93CC6325D5D4D752FCD8191E6CD2631D15947506BBEAF09FD896FEEB54F80314F797373793B7887C428669E6691CAA6B77C88A4B1248555DA3D1428E8A2803D6A8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002ABEA772B656134D27DCB78DE6381938546E9CFBF41CF3C558AA3E2738F0C6A9D7FE3CE6E83FD86A00B9F0BBC7FA7FC57F869E1DF15692D3B695E26D36DF55B269A3F2E4304F12CB1EE5FE16DAE323B1ADEAF29FD84BFE4C83E0DFF00D88DA27FE90415EAD4005145140051451400514514005798E93F0BEFB42FDA63C6DE30926B5934EF13685A2E996F0AEEF3A292CA5D49E42DC6DDADF6D880C1ECDED5E9D5E5BA3FC50D4B5CFDA7FC73E119E1B4FECAF0D683A26A76722A91334B7B2EA6930739C6DC59440607F1350076C28A074A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2803C7FF006E4B49AF7E06E9AB0C524ACBE3BF053908325557C57A4B31FC141278E80D7BD40FE644ADD73DEB89F881F12B4AF84FA1DBEADACCD35BD9CDA969FA4A3C71B484DC5F5EC1636EB85E70D3DCC409E8A09278048ED2D832C0BB86D6C723D3F2A00928A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BCAFF00678F86375F06FE19C7E1FBCBAB7BCB88F55D575032C219536DDEA575788B8619CAACFB4FFB51B638C57AA57907ECC3F12754F8B7F0A175CD6BECBFDA126B3AC5937910F96863B5D4EEAD62E3279F2E28C1CF52AC47045007A1D1451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400541A8C51CD652ACCAAD1323AB86C6D2A51B20E7D7F0E9D454F547C4EBBBC33AA7FD794C3EA361A00D3F00693A4787FC09A2D8787E2B38341B1B186DF4C8ECD835BC76A91AAC423209050205C10718C56BD794FEC23C7EC3FF06BFEC46D13FF004820AF56A0028A28A0028A28A0028A28A002BC67C31E1DD42CBF6D0F899AA4D63750E97A8785BC356F6B76D1910DC490CFAD34A8ADD0B209622476F317D6BD9AB85B7F8ABA7EBBF19FC45E0F8A0BB8F52F0BE9BA76A9733328F2658EF5EED6308739DCBF61949E3BAF5CD006F5140E945001451450014514500145145001451450014514500145145001451450014514500145145001451450078DFEDDA71F02F4BFEF7FC27DE09C0F5FF8AB747AF7E47DEB9C63DAB8EF1AF85345F1AE8D0D87882DEDEEB4F5BFB1BD58E790C6A2E6DEEE1B8B570411F32DCC703019E4800820915D7D9906D936FDDC71CE68024A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF14FD8FF00C2DA9782FE06C3A76AD6371A7DF2EBDAF5C18274DAE239B5ABE9A263ECF14B1B8F55753DEBDAEBCDFE0DFC53B4F8D3E0CFF8486C6CEEAC6DE4BFBED3FC99D90BAB5A5E4F68E7E53D19A2DC3FD974F4C000EB28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002AAEB16AB7FA65C5BB36D5B8864898F190A51B279F4F7E3D6AD553F10CAF0787F50923668DE3B595D587556087047D2801DF05BE1C5BFC1CF839E13F0859DCDC5EDAF85347B4D1A1B89C012CE96F0A42AEC071B88404E3B9AE9ABCE7F63BF146A1E37FD91FE166B5AB5E4DA86ADAC784349BDBDBA98E64B99E5B285E4918FF007999893EE6BD1A800A28A2800A28A2800A28A2800AF0CF07303FB787C59191B97C21E14C8CF4CDC6BD5EE75CABCBA0C9F117548ED1B4C6F11C7676A75258F67DB16DCB4C2DBCCC7CDB0B7DA7667807CC23BD005EA281D28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00F1BFDBB867E05697C67FE2BEF0476FFA9B747AFA015B70C8AF36F8D5F0921F8D9E0CB5D0EE2F25D3D2DF5DD1B5B13247E665B4ED52D75158C8240FDE35A04CE7E50E4E0E307D16D4E605E7771D477A00928A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BC13F6170ADFB3AC2C3FE864F128E3A0FF0089FEA3FE15EF75C3F81758D075DD1BED1E1BB8D36E349FB4DC448F641445E724F2A5C602803779E9206C7F1AC84F24D006E51451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400553D7E07BBD0EF618F1E65C5BCB12E4E00251B1DB8FA9E077AB95575ABA6B1D22F2E157735BDBC92A824804846C7D3EA39140197FB2E780350F851FB337C3BF0AEAC205D5BC33E18D374ABD10BF99189E0B58A2936B775DC8707B8AEEAB8DFD9D3E245C7C63FD9F7C0BE2FBAB586CAEBC57E1EB0D666B7858B4703DC5B47332293C9552E40CF3815D950014514500145145001451450015E17E0F897FE1BC3E2D36D1B9BC21E1404FAFFA46BFFE26BDD2B898BE1758685F17FC41E30864BAFED2F1369B61A65CAB3E6158EC9EE9E22AB8C86CDECB9E79DAB401B54503A5140051451400514514005145140051451400514514005145140051451400514514005145140051451401E63FB5CF8DF56F879F09B4FD4745BD934FBE97C63E14D39E5455626DEEFC49A65ADC47F30230F04D2A13D40724107047B44682340ABD07A9CD78FF00ED4FF0DB56F8AFF0B2C749D1A28A7BC87C59E18D59D2491631F67B1D7F4FBEB86CB1C6560B79580EAC400324807D7EDCE615E08F63DA801F45145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015E07FB0B26CFD9D61C1F97FE124F1271FF0071EBF1FF00B2F6F53DC927DF2B81F869F0DF4FF845E19FEC1D2D6E96C63BCBCBD1E7C9E63192EAEA6BB979C0C812CD2631D15947506803A2A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AA3E26C9F0DEA4AAA599ACE600004927637A0FF3EF57AABEA774B656134D27DCB78DE6381938546E9CFBF41CF3C500727FB1169F71A4FEC5FF00086D6EA09AD6EAD7C15A3453433466392175B18432B29E55810410790457A85617C2EF1FE9FF0015FE1A787BC53A4B4CFA578974DB7D56C9A68FCB90C13C4B2C7B97F85B6B8C8EC6B76800A28A2800A28A2800A28A2800AF15F0AEB77F73FB6BFC50D3E4BEBA934EB3F0AF8667B7B5790B436F2493EB624745E819FCA8B71EFE5AFA57B55798E93F0BEFF42FDA67C6DE30926B5934EF13685A26996D0AEEF3A392CA5D49E42DC636B7DB620307B37B50076438145028A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00E2BE3EFC5A9BE09F812CF5C86C63D424B8F11683A2794F218C2AEA3AC5969CD26E009CA2DDB381FC4500C8CE47A7C11F9312AF5C7703AD782FEDC96935EFC0DD35618A49597C77E0A721064AAAF8AF49663F40A093C7406BDEA17F32256EB9A00751451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005784FEC4BA85D6ABF00629EF2EAEAF273E21F10C7E74F3348E5535BBE4452589242AAED1E8A1474515EED5E55FB3C7C31BAF837F0CA3F0FDEDD5BDE5C47AAEABA819610CA9B6F352BABC45018672AB3853FED46D8E31401DCD1451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400551F139C786354EBFF001E7376FF0061AAF541A9451CF6722CCAAD1323AB86C6D2A51B20E7D7F0E9D4500719FB097FC9907C1BFF00B11B44FF00D2082BD5AB23E1FE91A4787BC09A2E9FE1F8ACE0D06C6C61B7D363B460D6F1DAA46AB108C824140814020F4C56BD0014514500145145001451450015E5DA3FC50D4B5CFDA7BC71E109A1B4FECBF0D683A26A76722A91334B7B2EA6930739C6DC59440607F1357A8D78CF863C3BA8597EDA1F137549AC6EA1D2F50F0B786ADED6EDA3221B89219F5A32A2B742C8258891DBCC5F5A00F4A1D28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00C3F1FFC49D2BE146876FAB6B33CD6F6736A5A7E928F1C6D213717D7B058DBAE179C34F731027A28249E0123B5B70CB0AEE186EE3D2BC0BF6ED38F817A5FF7BFE13EF04E07AFFC55BA3D7BF23EF5CF4A007514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140057907ECC5F12754F8B9F0A175CD67ECBFDA126B3AC5937910F96863B5D4EEAD62E324E7CB8A3073D4AB11C115EBF5E29FB1F785B52F067C0C874FD5AC6E74FBE5D7B5FB8304E9B5C4736B57D344C47A3C52C6E3D55D4F7A00F4FA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AA3E275DDE19D53FEBCA607DC6C357AAAEB16AB7FA65C5BB36D5B8864898F190A51B279F4F7E3D68038FF00D8478FD87FE0D7FD88DA27FE90415EAD5CCFC15F8716FF00073E0E784FC2169753DEDAF85346B4D1A1B89C012CE96F0A42AEC070188404E3B9AE9A800A28A2800A28A2800A28A2800AE1ADFE2AE9FAEFC66F11783E286EE3D4BC2FA6E9DAA5CCCCA3C9963BD7BB58C21CE772FD865278EEBD735DCD786783981FDBC3E2C8C8DCBE10F0A6467A66E35EA00F571D28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00C8F1AF85345F1B68D0D87882DEDEEB4F5BFB1BD58E690C6A2E6DAEE1B8B570411F32DCC703019E4800820915D7D9906D936FDDC71CE6BC0FF6ED19F815A5F19FF8AFBC11DBFEA6DD1EBE8056DC322800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF37F837F14ECFE34F833FE121B1B4BAB1B792FEFB4FF267642EAD69793DA39F949E19A2DC3AFCAE9E981E915E09FB0B80DFB3AC2C3FE864F128E3A0FF0089FEA3FE1401EBF4514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500154FC432BC1E1FD4248D9A378ED257561D55821C11F4AB954F5F81EEF43BD863C799716F2C4B9381928D8EDC7D4F03BD0060FEC79E28D43C71FB23FC2DD6B57BC9B50D5B58F086937D7B7531CC9733CB6713C9231FEF333127DCD7A35709FB2E780750F851FB337C3AF0B6ACB02EADE1AF0C69BA55E885FCC8C4F05AC514815BBAEE4383DC5777400514514005145140051451400572AF268327C44D552D1B4C6F11A59DA9D4963DBF6C5B72D30B6F331F36C2DF69D99E01F331DEBAAAF0BF07C4BFF0DE1F169B68DCDE10F0A027D7FD235FFF0013401EB03A5145140051451400514514005145140051451400514514005145140051451400514514005145140051451401C97C6AF84B0FC6CF065AE8771792E9E96FAEE8DAD09923F332DA76A96BA8AC641207EF1AD02673F2872707183E8B6A736EBCEEE3A8EF5E33FB5CF8E356F879F09B4FD4B45BD934FBE97C61E14D39E5455626DEEFC49A65ADC47F30230F04D2A13D40724107047B42208D36AF41EA73400EA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AE1FC0BAC683AE68DF68F0DCFA5DC693F69B8891EC4288BCE59E54B8002803779E9206C7575909E49AEE2BC0FF006164D9FB3AC38276FF00C249E24E3FEE3D7E3FF65FD4F724900F60A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AABAD5D358E917770ABB9ADEDE495412402551B1F4FAF5156AA8F89B27C35A90552CCD6730000272761F41FE7DE802BFECE9F11E7F8C7FB3EF817C5F756B0D95D78AFC3F61ACCD6F0B168EDDEE2DE3999149E4AA972013CE057655E5FF00B1169F71A4FEC5DF086D6EA09AD6EADBC15A3453433218E489D6C610CACA7956041041E4115EA1400514514005145140051451400571317C2EB0D0BE307883C610C975FDA5E26D36C34CBA467CC2B1D93DD3C4557190D9BD973CF3B56BB6AF16F0AEB9A85CFEDAFF001434F92FAEA4D36CFC2DE199EDED5E42D0DBC924FAD891D17A067F2A2DC7BF96BE9401E9A3A5140E05140051451400514514005145140051451400514514005145140051451400514514005145140051451401E73FB53FC36D5BE2BFC2CB1D27458629EF21F167863567492458C7D9EC7C41A75EDC3658819582DE5603AB1000C9201F5FB739857823D8F6AF31F8F9F16A5F829E05B3D721B18F5092E3C45A1689E53C8630A351D62CB4E6937004E516ED9C0FE2280646723D3E08FC98957AE3BE2801D45145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015C0FC33F86DA7FC22F0C8D074BFB50B18EF2F2";
        
        // ca28ArchiveDB09142012_135754
        // ca28LiveDB09142012_135754
        public SqlAbstractionLayer(String _serverName = @"SQLPRIMARY", String _dbName = "ca28LiveDB09142012_135754", String _dbUserName = @"EventViewer", String _dbPassword = "8eac0n#2")
        {
            dbUserName  = _dbUserName;
            dbPassword  = _dbPassword;
            serverName  = _serverName;
            dbName      = _dbName;
        }

        public bool DeleteRows(String tableName, Dictionary<String, String> WHERE, ref String errMsg)
        {
            // build our query:
            SqlConnectionStringBuilder conStr = new SqlConnectionStringBuilder();
            StringBuilder query = new StringBuilder();
            String qs = "";
            bool firstOne = true;

            query.Append("DELETE FROM ");
            query.Append(tableName.Trim());
            query.Append(" WHERE ");

            firstOne = true;
            foreach (KeyValuePair<String, String> item in WHERE)
            {
                if (firstOne)
                {
                    query.Append(item.Key);
                    query.Append(" = @");
                    query.Append(item.Key);
                    firstOne = false;
                }
                else
                {
                    query.Append(" AND ");
                    query.Append(item.Key);
                    query.Append(" = @");
                    query.Append(item.Key);
                }
            }

            qs = query.ToString();

            // Use the query here:
            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            try
            {
                using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
                {
                    SqlCommand command = new SqlCommand(qs, connection);

                    foreach (KeyValuePair<String, String> item in WHERE)
                    {
                        command.Parameters.AddWithValue("@" + item.Key, item.Value);
                    }

                    connection.Open();
                    command.ExecuteNonQuery();
                    connection.Close();
                }
            }
            catch (Exception ex)
            {
                errMsg = ex.Message;
                return false;
            }

            query.Clear();
            return true;
        }

        private bool DoInsert(String tableName, Dictionary<String, String> items, ref String errMsg)
        {
            // build our query:
            SqlConnectionStringBuilder conStr   = new SqlConnectionStringBuilder();
            StringBuilder query                 = new StringBuilder();
            String qs                           = "";
            bool firstOne                       = true;

            query.Append("INSERT INTO ");
            query.Append(tableName.Trim());
            query.Append(" (");

            firstOne = true;
            foreach (KeyValuePair<String, String> item in items)
            {
                if (firstOne)
                {
                    query.Append(item.Key);
                    firstOne = false;
                }
                else
                {
                    query.Append(", ");
                    query.Append(item.Key);
                }
            }

            query.Append(") VALUES (");

            firstOne = true;
            foreach (KeyValuePair<String, String> item in items)
            {
                if (firstOne)
                {
                    query.Append("@");
                    query.Append(item.Key);
                    firstOne = false;
                }
                else
                {
                    query.Append(", @");
                    query.Append(item.Key);
                }
            }

            query.Append(")");

            qs = query.ToString();

            // Use the query here:
            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false;
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            try
            {
                using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
                {
                    SqlCommand command = new SqlCommand(qs, connection);

                    foreach (KeyValuePair<String, String> item in items)
                    {
                        command.Parameters.AddWithValue("@" + item.Key, item.Value);
                    }

                    connection.Open();
                    command.ExecuteNonQuery();
                    connection.Close();
                }
            }
            catch (Exception ex)
            {
                errMsg = ex.Message;
                return false;
            }

            query.Clear();
            return true;
        }

        public bool CreateOperatorPrivilage(String privName, ref String errMsg)
        {
            Dictionary<String, String> values = new Dictionary<String, String>();
            int id = 0;

            if (!GetNewPrivilageIdNumber(ref id, ref errMsg))
            {
                errMsg = "Could not get new NoPriv (privilage id number)";
                return false;
            }

            values.Clear();
            values.Add("NoPriv", id.ToString());
            values.Add("Priv", privName);

            if (!DoInsert("dbo.Privileg", values, ref errMsg))
            {
                errMsg = "Could not add operator privilage configuration to the database: " + errMsg;
                return false;
            }

            return true;
        }

        public bool GetRows(String tableName, List<String> colNames, Dictionary<String, String> WHERE, ref List<Object[]> dbRows, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr   = new SqlConnectionStringBuilder();
            StringBuilder query                 = new StringBuilder();
            bool firstOne                       = true;

            if (dbRows == null) { dbRows = new List<Object[]>(); }
            dbRows.Clear();

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            query.Append("SELECT ");
            query.Append((colNames == null || colNames.Count.Equals(0) ? 
                (Func<String>)(() => { return "*"; }) : 
                (Func<String>)(() => {
                    foreach (String colName in colNames)
                    {
                        query.Append(firstOne ? colName : ", ");
                        if (!firstOne) { query.Append(colName); }

                        firstOne = false;
                    }
                    return " ";
                }))());

            query.Append(" FROM ");
            query.Append(tableName.Trim());

            if (!(WHERE == null || WHERE.Count.Equals(0)))
            {
                query.Append(" WHERE ");

                firstOne = true;
                foreach (KeyValuePair<String, String> item in WHERE)
                {
                    if (firstOne)
                    {
                        query.Append(item.Key);
                        query.Append(" = @");
                        query.Append(item.Key);
                        firstOne = false;
                    }
                    else
                    {
                        query.Append(" AND ");
                        query.Append(item.Key);
                        query.Append(" = @");
                        query.Append(item.Key);
                    }
                }
            }
            
            String queryString = query.ToString();
            Object[] row;

            using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
            {
                try
                {
                    SqlCommand command = new SqlCommand(queryString, connection);

                    if (!(WHERE == null))
                    {
                        foreach (KeyValuePair<String, String> item in WHERE)
                        {
                            command.Parameters.AddWithValue("@" + item.Key, item.Value);
                        }
                    }
                    
                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        row = new Object[reader.FieldCount];
                        reader.GetValues(row);
                        dbRows.Add(row);
                    }

                    reader.Close();
                }
                catch (Exception ex)
                {
                    errMsg = ex.Message;
                    return false;
                }

                return true;
            }
        }

        public bool DeletePartition(String partitionName, ref String errMsg)
        {
            Dictionary<String, String> values = new Dictionary<String, String>();

            values.Add("Name", partitionName);

            return DeleteRows("dbo.Groups", values, ref errMsg);
        }

        public bool CreateOperator(String scrName, String fullName, String privGroup, ref String errMsg)
        {
            Dictionary<String, String> values   = new Dictionary<String, String>();
            int privNo                          = 0;
            int newOpNo                         = 0;

            if (!GetPrivNumber(privGroup, ref errMsg))
            {
                errMsg = "Could not create operator because the privilage group specified could not be found: " + errMsg;
                return false;
            }

            try
            {
                privNo = int.Parse(errMsg);
            }
            catch (Exception)
            {
                errMsg = "Unexpected result from 'GetPrivNumber' Could con convert '" + errMsg + "' to an integer.";
            }

            if (!GetNewOperatorIdNumber(ref newOpNo, ref errMsg))
            {
                errMsg = "Could not get new operator id: " + errMsg;
                return false;
            }

            // password 'new' = 09EBA42BC31824

            values.Clear();
            values.Add("OpNo", newOpNo.ToString());
            values.Add("ScrName", scrName);
            values.Add("Name", fullName);
            values.Add("Passwrd", "09EBA42BC31824"); // Set the new operator's login to 'new'.
            values.Add("Priv", privNo.ToString());
            values.Add("Changed", DateTime.Now.ToString());
            values.Add("GroupNo", "0");
            values.Add("AckTO", "5");
            values.Add("Opt", "0");
            values.Add("Flag", "1");
            values.Add("AutoAck", "0");
            values.Add("UP_CBCaptions", "1");
            values.Add("UP_CBIcons", "1");
            values.Add("UP_UseBg", "1");
            values.Add("UP_BgIndex", "0");
            values.Add("UP_X", "10");
            values.Add("UP_Y", "10");
            values.Add("UP_Width", "1024");
            values.Add("UP_Height", "768");
            values.Add("UP_Monitor", "1");
            values.Add("UP_Control", "1");
            values.Add("UP_ShowPhoto", "0");
            values.Add("LogOffTime", "5");
            values.Add("EventViewCount", "10");
            values.Add("EventViewDay", "1");
            values.Add("EventViewSpan", "1");
            values.Add("OperUseSNPP", "0");
            values.Add("OperUseEmail", "0");
            values.Add("OperSNPPHostId", "0");
            values.Add("ManualControlDblClick", "0");

            if (!DoInsert("dbo.Oper", values, ref errMsg))
            {
                errMsg = "Could not add operator privilage configuration to the database: " + errMsg;
                return false;
            }

            return true;
        }

        public bool CreateMap(String name, ref int mapId, ref String errMsg)
        {
            Dictionary<String, String> values   = new Dictionary<String, String>();
            List<String> collNames              = new List<String>();
            List<Object[]> rows;
            int newMapId = 0;

            rows = new List<Object[]>();
            collNames.Add("MapId");
            collNames.Add("MapName");

            if (!GetRows("dbo.Map", collNames, null, ref rows, ref errMsg))
            {
                errMsg = "Could not get the next panel number, because the current list of panels coud not be retrieved: " + errMsg;
                return false;
            }

            try
            {
                foreach (Object[] row in rows)
                {
                    if (name.ToLower().Trim().Equals(row[1].ToString().ToLower().Trim()))
                    {
                        errMsg = "Duplicate map already exists in the database!";
                        return false;
                    }
                }
            }
            catch (Exception ex)
            {
                errMsg = "Unexpected data returned for dbo.Map.MapName: " + ex.Message;
                return false;
            }

            // Get the new panel id:
            try
            {
                foreach (Object[] row in rows)
                {
                    newMapId = (newMapId < int.Parse(row[0].ToString())) ? int.Parse(row[0].ToString()) : newMapId;
                }
            }
            catch (Exception ex)
            {
                errMsg = "Unexpected data returned for dbo.Map.MapId: " + ex.Message;
                return false;
            }

            newMapId    += 1;
            mapId       = newMapId;

            values.Add("MapId", newMapId.ToString());
            values.Add("MapName", name);

            if (!DoInsert("dbo.Map", values, ref errMsg))
            {
                errMsg = "Could not add operator privilage configuration to the database: " + errMsg;
                return false;
            }

            return true;
        }

        public bool CreatPanel(String description, String privGroup, String GroupName, int mapId, ref String errMsg)
        {
            Dictionary<String, String> values = new Dictionary<String, String>();
            List<Object[]> rows;
            List<String> cols   = new List<String>();
            String tmp          = "";
            String deviceId     = "";
            int privNo          = 0;
            int groupNo         = 0;
            int devIdLength     = 12;
            int thisNumber      = 0;
            int newPanelNumber  = 0;
            int newCommPort     = 0;
            bool exit           = true;
            Guid guid;

            if (!GetPrivNumber(privGroup, ref errMsg))
            {
                errMsg = "Could not create operator because the privilage group specified could not be found: " + errMsg;
                return false;
            }

            try
            {
                privNo = int.Parse(errMsg);
            }
            catch (Exception)
            {
                errMsg = "Unexpected result from 'GetPrivNumber' Could con convert '" + errMsg + "' to an integer.";
            }

            rows = new List<Object[]>();
            if (!GetRows("dbo.Panel", null, null, ref rows, ref errMsg))
            {
                errMsg = "Could not get the next panel number, because the current list of panels coud not be retrieved: " + errMsg;
                return false;
            }

            // Get the new panel id:
            foreach (Object[] row in rows)
            {
                thisNumber      = int.Parse(row[0].ToString());
                newPanelNumber  = (thisNumber > newPanelNumber) ? thisNumber : newPanelNumber;
            }

            newPanelNumber += 1;

            while (true)
            {
                // Verify the new GUID is unique:
                guid = Guid.NewGuid();
                exit = true;
                foreach (Object[] row in rows)
                {
                    tmp = row[30].ToString();
                    if(guid.ToString().Equals(tmp)) { exit = false; }
                }

                if (exit) { break; }
            }

            // Get the next available comm port:
            thisNumber = 0;
            foreach (Object[] row in rows)
            {
                thisNumber      = int.Parse(row[3].ToString());
                newCommPort  = (thisNumber > newCommPort) ? thisNumber : newCommPort;
            }

            newCommPort += 1;
            deviceId    = newCommPort.ToString();

            tmp = newPanelNumber.ToString();

            if (tmp.Length < 3)
            {
                tmp = (tmp.Length == 1) ? ".00" + tmp + ".000" : ".0" + tmp + ".00";
            }

            // Get Group Number:
            rows = new List<Object[]>();
            cols.Clear();
            cols.Add("ItemNo");
            cols.Add("Name");

            values.Clear();
            values.Add("Name", GroupName);

            if (!GetRows("dbo.Groups", cols, values, ref rows, ref errMsg))
            {
                errMsg = "Could not get the group id number, because the current list of groups coud not be retrieved: " + errMsg;
                return false;
            }

            if (!(rows.Count > 0))
            {
                errMsg = "Could not get the group id number, because no groups could be retrieved from the database.";
                return false;
            }

            try
            {
                groupNo = int.Parse(rows[0][0].ToString());
            }
            catch (Exception ex)
            {
                errMsg = "Unexpected data from the database! the error returned is:" + ex.Message;
                return false;
            }

            // Build the Device Id:
            devIdLength = devIdLength - deviceId.Length;
            for (int count = 0; count < devIdLength; count++)
            {
                deviceId = "0" + deviceId;
            }
            deviceId = "000." + deviceId + tmp;

            values.Clear();
            values.Add("PnlNo", newPanelNumber.ToString());
            values.Add("Description", description);
            values.Add("Address", "1");
            values.Add("ComPort", newCommPort.ToString());
            values.Add("Cluster", "0");
            values.Add("Enabled", "1");
            values.Add("Interactive", "0");
            values.Add("NoFail", "0");
            values.Add("XactSize", "1000");
            values.Add("Node", "0");
            values.Add("Changed", DateTime.Now.ToString());
            values.Add("GroupNo", groupNo.ToString());
            values.Add("Flag", "0");
            values.Add("MapId", mapId.ToString());
            values.Add("DeviceId", deviceId);
            values.Add("CommPrior", "50");
            values.Add("DwnLoadPrior", "70");
            values.Add("PwrPrior", "20");
            values.Add("RespReq", "0");
            values.Add("Schedules", "150");
            values.Add("Elevators", "0");
            values.Add("ModemPrior", "50");
            values.Add("Passwrd", "0");
            values.Add("DegradeMode", "0");
            values.Add("AGSize", "256");
            values.Add("Sphere", "0");
            values.Add("PanelType", "3");
            values.Add("caObjectId", guid.ToString());
            values.Add("MaxAlp", "227");
            values.Add("MaxEvt", "227");
            values.Add("DefaultCalendar", "0");
            values.Add("NAPCOPanel", "0");
            values.Add("ZoneId", "30");
            values.Add("LockUpdateSchedule", "0");
            values.Add("LockType", "0");
            values.Add("LockAssigned", "0");
            values.Add("LockChanged", "0");
            values.Add("RemoteDevice", "0");

            errMsg = "";
            if (!DoInsert("dbo.Panel", values, ref errMsg))
            {
                errMsg = "Could not add panel to the database: " + errMsg;
                return false;
            }

            return true;
        }

        public bool CreatePartition(String partitionName, ref String errMsg)
        {

            Dictionary<String, String> values   = new Dictionary<String, String>();
            List<int> groupIds                  = new List<int>();
            int itemNo                          = GetNewGroupItemNumber(ref errMsg);

            if (itemNo < 0)
            {
                return false;
            }

            for (int i = 0; i < 22; i++)
            {
                if (i != 2 && i != 5 && i != 10 && i != 11 && i != 18)
                {
                    groupIds.Add(i);
                }
            }

            foreach (int id in groupIds)
            {
                values.Clear();
                values.Add("GroupId", id.ToString());
                values.Add("ItemNo", itemNo.ToString());
                values.Add("Name", partitionName);
                values.Add("Activ", "0");
                values.Add("Flag", "0");
                values.Add("Changed", DateTime.Now.ToString());

                if (!DoInsert("dbo.Groups", values, ref errMsg))
                {
                    errMsg = "Could not add group configuration to the database: " + errMsg;
                    return false;
                }
            }

            return true;
        }


        public bool GetPartitionList(ref List<String> partitionNames, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr = new SqlConnectionStringBuilder();

            if (partitionNames == null) { partitionNames = new List<String>(); }
            partitionNames.Clear();

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            String queryString = "SELECT [Name] FROM Groups";

            using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
            {
                try
                {
                    int paramValue1 = 1;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@Name", paramValue1);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        if (!partitionNames.Contains(reader[0].ToString()))
                        {
                            partitionNames.Add(reader[0].ToString());
                        }
                    }

                    reader.Close();
                }
                catch (Exception ex)
                {
                    errMsg = ex.Message;
                    return false;
                }

                return true;
            }
        }

        public bool GetAccessGroupObjId(int GroupId, ref String objId, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr = new SqlConnectionStringBuilder();

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;
            objId                       = "";

            String queryString = "SELECT [caObjectId] FROM AccGrp WHERE Agno=" + GroupId;

            using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
            {
                try
                {
                    int paramValue1 = 1;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@caObjectId", paramValue1);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        //if (!partitionNames.Contains(reader[0].ToString()))
                        //{
                        //    partitionNames.Add(reader[0].ToString());
                        //}
                        objId = reader[0].ToString();
                        break;
                    }

                    reader.Close();
                }
                catch (Exception ex)
                {
                    errMsg = ex.Message;
                    return false;
                }

                return true;
            }
        }

        public bool GetPartitionAndGroupNo(ref Dictionary<String, int> combo, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr = new SqlConnectionStringBuilder();

            if (combo == null) { combo = new Dictionary<String, int>(); }
            combo.Clear();

            conStr.DataSource = serverName;
            conStr.InitialCatalog = dbName;
            conStr.IntegratedSecurity = false; // Sql Server Authentification
            conStr.UserID = dbUserName;
            conStr.Password = dbPassword;

            String queryString = "SELECT [Name], [ItemNo] FROM Groups";

            using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
            {
                try
                {
                    int paramValue1 = 1;
                    int paramValue2 = 2;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@Name", paramValue1);
                    command.Parameters.AddWithValue("@ItemNo", paramValue2);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        if (!combo.Keys.Contains(reader[0].ToString()))
                        {
                            combo.Add(reader[0].ToString(), Int32.Parse(reader[1].ToString()));
                        }
                    }

                    reader.Close();
                }
                catch (Exception ex)
                {
                    errMsg = ex.Message;
                    return false;
                }

                return true;
            }
        }

        public bool GetCardInfoByOrg(String orgName, ref String csv, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr   = new SqlConnectionStringBuilder();
            StringBuilder sb                    = new StringBuilder();
            Dictionary<String, String> accGroup = new Dictionary<String, String>();
            int groupNo                         = -1;

            Dictionary<String, int> combo = new Dictionary<String, int>();
            //combo.Clear();

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            if (!GetPartitionAndGroupNo(ref combo, ref errMsg))
            {
                return false;
            }

            if (!combo.TryGetValue(orgName, out groupNo))
            {
                errMsg = "Organization not found!";
                return false;
            }

            String queryString          = "SELECT [Badge], [AGroup1], [Enabled], [LastName], [FrstName] FROM Badge WHERE GroupNo=" + groupNo;

            using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
            {
                try
                {
                    String val      = "";
                    int paramValue1 = 1;
                    int paramValue2 = 2;
                    int paramValue3 = 3;
                    int paramValue4 = 4;
                    int paramValue5 = 5;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@Badge", paramValue1);
                    command.Parameters.AddWithValue("@AGroup1", paramValue2);
                    command.Parameters.AddWithValue("@Enabled", paramValue3);
                    command.Parameters.AddWithValue("@LastName", paramValue4);
                    command.Parameters.AddWithValue("@FrstName", paramValue5);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    sb.Append("LAST NAME");
                    sb.Append(", ");
                    sb.Append("FIRST NAME");
                    sb.Append(", ");
                    sb.Append("BADGE NUMBER");
                    sb.Append(", ");
                    sb.Append("ACCESS GROUP ID");
                    sb.Append(", ");
                    sb.Append("ENABLED / DISABLED\n");

                    while (reader.Read())
                    {
                        //if (!combo.Keys.Contains(reader[0].ToString()))
                        //{
                        //    combo.Add(reader[0].ToString(), Int32.Parse(reader[1].ToString()));
                        //}
                        sb.Append(reader[3].ToString().Replace(",", ""));
                        sb.Append(", ");
                        sb.Append(reader[4].ToString().Replace(",", ""));
                        sb.Append(", ");
                        sb.Append(reader[0].ToString().Replace(",", ""));
                        sb.Append(", ");

                        val = "";
                        if (accGroup.TryGetValue(reader[1].ToString(), out val))
                        {
                            sb.Append(val);
                        }
                        else
                        {
                            if(GetAccessGroupObjId(int.Parse(reader[1].ToString()), ref val, ref errMsg)) 
                            {
                                accGroup.Add(reader[1].ToString(), val);
                                sb.Append(val);
                            }
                        }

                        //sb.Append(reader[1].ToString());
                        sb.Append(", ");
                        sb.Append(bool.Parse(reader[2].ToString()) == true ? "Enabled\n" : "Disabled\n");
                    }

                    reader.Close();
                    csv = sb.ToString();
                }
                catch (Exception ex)
                {
                    errMsg = ex.Message;
                    return false;
                }

                return true;
            }
        }

        private bool GetGroupItemNo(String name, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr = new SqlConnectionStringBuilder();

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            errMsg = "";

            String queryString = "SELECT [ItemNo] FROM Groups WHERE Name = '" + name + "'";

            using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
            {
                try
                {
                    int paramValue = 1;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@ItemNo", paramValue);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        errMsg = reader[0].ToString();
                    }

                    reader.Close();
                }
                catch (Exception ex)
                {
                    errMsg = ex.Message;
                    connection.Close();
                    return false;
                }

                connection.Close();

                if (errMsg.Trim().Equals("")) { errMsg = "No data returned."; return false; }
                return true;
            }
        }



        private bool GetPrivNumber(String priv, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr = new SqlConnectionStringBuilder();

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            errMsg = "";

            String queryString = "SELECT [NoPriv] FROM Privileg WHERE Priv = '" + priv + "'";
            try
            {
                using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
                {

                    int paramValue = 1;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@NoPriv", paramValue);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        errMsg = reader[0].ToString();
                    }

                    reader.Close();
                    connection.Close();

                    if (errMsg.Trim().Equals("")) { errMsg = "No data returned."; return false; }
                    return true;
                }
            }
            catch (Exception ex)
            {
                errMsg = ex.Message;
                return false;
            }
        }

        private bool VerifyPartitionExists(String partitionName, ref String errMsg)
        {

            List<String> partitions = new List<String>();

            if (!GetPartitionList(ref partitions, ref errMsg))
            {
                errMsg = "Could not get the list of partitions from the database: " + errMsg;
                return false;
            }

            foreach (String partition in partitions)
            {
                if (partition.Trim().ToLower().Equals(partitionName.Trim().ToLower()))
                {
                    errMsg = partitionName + " exists.";
                    return true;
                }
            }

            errMsg = partitionName + " does not exist.";
            return false;
        }

        /// <summary>
        /// You must create a partition and a privilage of the same name first!
        /// </summary>
        /// <param name="partitionName"></param>
        /// <param name="errMsg"></param>
        /// <returns></returns>
        public bool CreateSphere(String partitionName, ref String errMsg)
        {
            int groupItemNo                     = 0;
            int NoPriv                          = 0;
            Dictionary<String, String> values   = new Dictionary<String, String>();
            List<int> groupIds                  = new List<int>();

            if (!VerifyPartitionExists(partitionName, ref errMsg))
            {
                errMsg = "Can not create sphere: Database partition does not exist.";
                return false;
            }

            if (!GetGroupItemNo(partitionName, ref errMsg))
            {
                errMsg = "Could not get GroupItemNo: " + errMsg;
                return false;
            }
            else
            {
                try
                {
                    groupItemNo = int.Parse(errMsg);
                }
                catch (Exception)
                {
                    errMsg = "Could not retrieve the groupItemNo for partition: " + partitionName;
                    return false;
                }
            }

            if (!GetPrivNumber(partitionName, ref errMsg))
            {
                errMsg = "Could not get GroupItemNo: " + errMsg;
                return false;
            }
            else
            {
                try
                {
                    NoPriv = int.Parse(errMsg);
                }
                catch (Exception)
                {
                    errMsg = "Could not retrieve the NoPriv number for the Operator Privelage: " + partitionName;
                    return false;
                }
            }

            for (int i = 0; i < 22; i++)
            {
                if (i != 2 && i != 5 && i != 10 && i != 11 && i != 18)
                {
                    groupIds.Add(i);
                }
            }

            foreach (int id in groupIds)
            {
                values.Clear();
                values.Add("OperPrivId", NoPriv.ToString());
                values.Add("GroupId", id.ToString());
                values.Add("GroupNo", groupItemNo.ToString());
                values.Add("Changed", DateTime.Now.ToString());
                values.Add("Partition", (id == 0) ? groupItemNo.ToString() : id.ToString() + "00" + groupItemNo.ToString());
                values.Add("Restriction", "0");

                if (!DoInsert("dbo.Sphere", values, ref errMsg))
                {
                    errMsg = "Could not add group configuration to the database: " + errMsg;
                    return false;
                }
            }

            return true;
        }

        public bool GetNewOperatorIdNumber(ref int id, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr   = new SqlConnectionStringBuilder();
            List<int> itemNumbers               = new List<int>();
            int itemNumber                      = 0;

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false;
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            String queryString = "SELECT [OpNo] FROM Oper";

            try
            {
                using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
                {

                    int paramValue = 1;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@OpNo", paramValue);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        if (!itemNumbers.Contains(Int32.Parse(reader[0].ToString())))
                        {
                            itemNumbers.Add(Int32.Parse(reader[0].ToString()));
                        }
                    }

                    if (itemNumbers.Count > 0)
                    {
                        foreach (Int32 number in itemNumbers)
                        {
                            if (number > itemNumber) { itemNumber = number; }
                        }
                    }

                    reader.Close();

                    id = (itemNumber + 1);
                    return true;
                }
            }
            catch (Exception ex)
            {
                errMsg = ex.Message;
                id = -1;
                return false;
            }
        }

        private bool GetNewPrivilageIdNumber(ref int id, ref String errMsg)
        {
            SqlConnectionStringBuilder conStr   = new SqlConnectionStringBuilder();
            List<int> itemNumbers               = new List<int>();
            int itemNumber                      = 0;

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false;
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            String queryString = "SELECT [NoPriv] FROM Privileg";

            try
            {
                using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
                {

                    int paramValue = 1;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@NoPriv", paramValue);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        if (!itemNumbers.Contains(Int32.Parse(reader[0].ToString())))
                        {
                            itemNumbers.Add(Int32.Parse(reader[0].ToString()));
                        }
                    }

                    if (itemNumbers.Count > 0)
                    {
                        foreach (Int32 number in itemNumbers)
                        {
                            if (number > itemNumber) { itemNumber = number; }
                        }
                    }

                    reader.Close();

                    id = (itemNumber + 1);
                    return true;
                }
            }
            catch (Exception ex)
            {
                errMsg = ex.Message;
                id = -1;
                return false;
            }
        }

        public int GetNewGroupItemNumber(ref String errMsg)
        {
            SqlConnectionStringBuilder conStr   = new SqlConnectionStringBuilder();
            List<int> itemNumbers               = new List<int>();
            int itemNumber                      = 0;

            conStr.DataSource           = serverName;
            conStr.InitialCatalog       = dbName;
            conStr.IntegratedSecurity   = false; // Sql Server Authentification
            conStr.UserID               = dbUserName;
            conStr.Password             = dbPassword;

            String queryString = "SELECT [ItemNo] FROM Groups";

            using (SqlConnection connection = new SqlConnection(conStr.ConnectionString))
            {
                try
                {
                    int paramValue = 1;
                    SqlCommand command = new SqlCommand(queryString, connection);
                    command.Parameters.AddWithValue("@ItemNo", paramValue);

                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    while (reader.Read())
                    {
                        if (!itemNumbers.Contains(Int32.Parse(reader[0].ToString())))
                        {
                            itemNumbers.Add(Int32.Parse(reader[0].ToString()));
                        }
                    }

                    if (itemNumbers.Count > 0)
                    {
                        foreach (Int32 number in itemNumbers)
                        {
                            if (number > itemNumber) { itemNumber = number; }
                        }
                    }

                    reader.Close();
                }
                catch (Exception ex)
                {
                    errMsg = ex.Message;
                    return -1;
                }

                return itemNumber + 1;
            }
        } // - END GetNewGroupItemNumber()
    }
}
